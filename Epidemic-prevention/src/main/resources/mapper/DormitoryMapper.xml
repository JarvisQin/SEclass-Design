<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ssm.dao.DormitoryDao">

    <resultMap id="dormitoryResultMap" type="ssm.domain.Dormitory">
        <id property="dormitoryId" column="dormitoryId"/>
        <result property="dormitoryNumber" column="dormitoryNumber"/>
        <result property="dormitoryPhoto" column="dormitoryPhoto"/>
        <result property="dormitoryPhotoDetail" column="dormitoryPhotoDetail"/>


        <collection property="studentList" javaType="ArrayList"
                    column="dormitoryId" ofType="ssm.domain.Student"
                    select="ssm.dao.StudentDao.getStudentByDormitoryId"
                    fetchType="eager"><!--这里如果是lazy 懒加载会造成json异常-->
            <id property="id" column="id"/>
            <!--只查询了课程名称-->
            <result property="username" column="username"/>

        </collection>
    </resultMap>

    <select id="getDormitoryById" resultType="ssm.domain.Dormitory">
        select * from dormitory where dormitoryId=#{dormitoryId}
    </select>

    <select id="getAllDormitories" resultType="ssm.domain.Dormitory">
        select * from dormitory
    </select>

    <select id="getDormitoryList" resultMap="dormitoryResultMap">
        select * from dormitory
    </select>

    <select id="checkDormitoryNumber" resultType="ssm.domain.Dormitory">
        select * from dormitory where dormitoryNumber=#{dormitoryNumber}
    </select>
    <insert id="addDormitory" parameterType="ssm.domain.Dormitory">
        insert into dormitory(dormitoryNumber, dormitoryPhoto,dormitoryPhotoDetail)
        VALUES(#{dormitoryNumber},#{dormitoryPhoto},#{dormitoryPhotoDetail})
    </insert>
    <delete id="deleteByDormitoryId">
        delete from dormitory where dormitoryId=#{dormitoryId}
    </delete>
</mapper>