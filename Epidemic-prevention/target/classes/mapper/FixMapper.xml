<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ssm.dao.FixDao">

    <resultMap id="fixResultMap" type="ssm.domain.Fix">
        <id property="fixId" column="fixId"/>
        <result property="fixTime" column="fixTime"/>
        <result property="fixStatus" column="fixStatus"/>
        <result property="fixNote" column="fixNote"/>


        <association property="admin" javaType="ssm.domain.Admin">
            <id property="adminId" column="adminId"/>
            <result property="username" column="username"/>
        </association>
        <association property="dormitory" javaType="ssm.domain.Dormitory">
            <id property="dormitoryId" column="dormitoryId"/>
            <result property="dormitoryNumber" column="dormitoryNumber"/>
        </association>

    </resultMap>

    <select id="getFixList" resultMap="fixResultMap">
        select * from fix ,admin,dormitory
        where fix.fixPepoleId=admin.adminId and fix.dormitoryId=dormitory.dormitoryId
    </select>

    <insert id="addFix" parameterType="ssm.domain.Fix">
        insert into fix(fixTime, dormitoryId, fixPepoleId, fixStatus,fixNote)
        VALUES(#{fixTime},#{dormitoryId},#{fixPepoleId},#{fixStatus},#{fixNote})
    </insert>

    <select id="getFixById" resultType="ssm.domain.Fix">
        select * from fix where fixId=#{fixId}
    </select>

    <update id="updateFix" parameterType="ssm.domain.Fix">
        update fix
        <set>
            <if test="fixTime!=null">
                fixTime=#{fixTime},
            </if>
            <if test="fixPepoleId!=null">
                fixPepoleId=#{fixPepoleId},
            </if>
            <if test="dormitoryId!=null">
                dormitoryId=#{dormitoryId},
            </if>
            <if test="fixStatus!=null">
                fixStatus=#{fixStatus},
            </if>
            <if test="fixNote!=null">
                fixNote=#{fixNote}
            </if>
        </set>
        where fixId=#{fixId}
    </update>
    <delete id="deleteFixById">
        delete from fix where fixId=#{fixId}
    </delete>

</mapper>